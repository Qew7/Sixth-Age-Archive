<!DOCTYPE html>
<html class="h-full">
  <head>
    <title><%= content_for(:title) || "Sixth Age Archive" %> | Warhammer Fantasy 6th Edition</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="description" content="Complete archive of Warhammer Fantasy 6th Edition rules, army books, and army builder">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Google Fonts - Cinzel for headers (gothic), Crimson Text for body %>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">

    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    
    <style>
      .font-cinzel { font-family: 'Cinzel', serif; }
      .font-serif { font-family: 'Crimson Text', Georgia, serif; }
    </style>
  </head>

  <body class="h-full bg-stone-950 text-stone-200 font-serif antialiased">
    <%# Background texture overlay %>
    <div class="fixed inset-0 opacity-30 pointer-events-none -z-10" style="background-image: url('data:image/svg+xml,%3Csvg width=%2260%22 height=%2260%22 viewBox=%220 0 60 60%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cpath d=%22M54.627 0l.83.828-1.415 1.415L51.8 0h2.827zM5.373 0l-.83.828L5.96 2.243 8.2 0H5.374zM48.97 0l3.657 3.657-1.414 1.414L46.143 0h2.828zM11.03 0L7.372 3.657 8.787 5.07 13.857 0H11.03zM32 0l3.885 3.885-1.414 1.414L32 2.828 29.53 5.3l-1.415-1.414L32 0zM0 32l3.885-3.885 1.414 1.414L2.828 32l2.471 2.471-1.414 1.415L0 32z%22 fill=%22%23292524%22 fill-opacity=%220.4%22 fill-rule=%22evenodd%22/%3E%3C/svg%3E');"></div>

    <%# Navigation %>
    <nav class="fixed top-0 left-0 right-0 z-50 bg-stone-900/95 backdrop-blur-sm border-b border-amber-900/50 shadow-lg">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <%# Logo %>
          <%= link_to root_path, class: "flex items-center gap-3 group" do %>
            <div class="w-10 h-10 rounded bg-gradient-to-br from-amber-600 to-amber-800 flex items-center justify-center shadow-lg border border-amber-500/50">
              <svg class="w-6 h-6 text-amber-100" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
              </svg>
            </div>
            <div>
              <h1 class="font-cinzel text-lg font-bold text-amber-100 group-hover:text-amber-300 transition-colors">Sixth Age Archive</h1>
              <p class="text-xs text-stone-500 -mt-0.5">Warhammer Fantasy 6th Edition</p>
            </div>
          <% end %>

          <%# Navigation Links %>
          <div class="hidden md:flex items-center gap-1">
            <%= link_to "Rules", rulebooks_path, class: "px-4 py-2 text-stone-300 hover:text-amber-400 font-medium transition-colors" %>
            <%= link_to "Armies", armies_path, class: "px-4 py-2 text-stone-300 hover:text-amber-400 font-medium transition-colors" %>
            <%= link_to "Army Builder", army_lists_path, class: "px-4 py-2 text-stone-300 hover:text-amber-400 font-medium transition-colors" %>
          </div>

          <%# Mobile menu button %>
          <button type="button" class="md:hidden p-2 text-stone-400 hover:text-amber-400" data-controller="mobile-menu" data-action="click->mobile-menu#toggle">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
        </div>
      </div>

      <%# Mobile menu %>
      <div class="md:hidden hidden" id="mobile-menu">
        <div class="px-4 py-3 space-y-1 bg-stone-900 border-t border-stone-800">
          <%= link_to "Rules", rulebooks_path, class: "block px-3 py-2 text-stone-300 hover:text-amber-400 hover:bg-stone-800 rounded" %>
          <%= link_to "Armies", armies_path, class: "block px-3 py-2 text-stone-300 hover:text-amber-400 hover:bg-stone-800 rounded" %>
          <%= link_to "Army Builder", army_lists_path, class: "block px-3 py-2 text-stone-300 hover:text-amber-400 hover:bg-stone-800 rounded" %>
        </div>
      </div>
    </nav>

    <%# Flash messages %>
    <% if notice.present? %>
      <div class="fixed top-20 left-1/2 -translate-x-1/2 z-50 px-6 py-3 bg-emerald-900/90 border border-emerald-600 rounded-lg shadow-xl text-emerald-100 backdrop-blur-sm" data-controller="flash" data-flash-delay-value="3000">
        <%= notice %>
      </div>
    <% end %>
    <% if alert.present? %>
      <div class="fixed top-20 left-1/2 -translate-x-1/2 z-50 px-6 py-3 bg-red-900/90 border border-red-600 rounded-lg shadow-xl text-red-100 backdrop-blur-sm" data-controller="flash" data-flash-delay-value="3000">
        <%= alert %>
      </div>
    <% end %>

    <%# Main content %>
    <main class="min-h-screen pt-16">
      <%= yield %>
    </main>

    <%# Footer %>
    <footer class="bg-stone-900 border-t border-stone-800 mt-auto">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <h3 class="font-cinzel text-amber-400 font-semibold mb-4">Sixth Age Archive</h3>
            <p class="text-stone-500 text-sm leading-relaxed">
              A community resource for Warhammer Fantasy 6th Edition. 
              All rules and army lists from official sources.
            </p>
          </div>
          <div>
            <h3 class="font-cinzel text-amber-400 font-semibold mb-4">Resources</h3>
            <ul class="space-y-2 text-sm">
              <li><%= link_to "Core Rules", rulebooks_path, class: "text-stone-400 hover:text-amber-400 transition-colors" %></li>
              <li><%= link_to "Army Books", armies_path, class: "text-stone-400 hover:text-amber-400 transition-colors" %></li>
              <li><%= link_to "Army Builder", army_lists_path, class: "text-stone-400 hover:text-amber-400 transition-colors" %></li>
            </ul>
          </div>
          <div>
            <h3 class="font-cinzel text-amber-400 font-semibold mb-4">Community</h3>
            <ul class="space-y-2 text-sm">
              <li><a href="https://6th.whfb.app/" target="_blank" class="text-stone-400 hover:text-amber-400 transition-colors">6th Edition Rules Index</a></li>
            </ul>
          </div>
        </div>
        <div class="mt-8 pt-8 border-t border-stone-800 text-center text-stone-600 text-sm">
          <p>This is a fan project. Warhammer Fantasy is a trademark of Games Workshop Ltd.</p>
          <p class="mt-1">This site is not affiliated with Games Workshop.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
